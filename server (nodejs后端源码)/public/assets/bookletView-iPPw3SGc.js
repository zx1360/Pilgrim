import{_ as x,a as U,u as j}from"./index-C9jkMtV2.js";import{r as d,i as D,q as l,v as n,C as S,N as A,D as R,u as $,y as t,G as b,H as w,L as p,A as I,O as J,P as O,Q as G,E as H,F as M,p as F}from"./@vue-CrxPK7X6.js";import{a as B}from"./axios-xsH4HHeE.js";import"./vue-router-DQhqLy48.js";import"./pinia-BiUrJzFP.js";const P={class:"tasks"},Q={class:"task_img"},K=["onClick","src"],W={class:"task_context"},X={class:"title_box",contenteditable:"true"},Y={class:"desc_box",contenteditable:"true"},Z=["onClick"],tt={class:"bottom"},st={key:0,class:"new_tasks"},et={class:"task"},ot={class:"task_img"},it=["onChange"],at=["src"],nt={class:"task_context"},lt=["onBlur"],ct=["onBlur"],rt={class:"modify_btns iconfont"},_t={__name:"routine",emits:["show_info","refresh"],setup(k,{emit:f}){const c=f,r=d(null),u=d([]),o=d([]),i=d("");function v(){B.get("/api/booklet/routine/today").then(e=>{const s=e.data;r.value=s.style.style_id,u.value=s.tasks,o.value=u.value.map(a=>parseInt(a.is_done)),i.value=s.message,c("show_info",[`始于: ${s.style.start_date}`,`${s.style.valid_checkin} 打卡天数`,`${s.style.fully_done} 全通天数`,`${s.style.longest_streak} 最长连续打卡天数`,`${s.style.longest_fully_streak} 最长连续全通天数`])}).catch(e=>{console.error(e)})}v();function g(e){o.value.splice(e,1,1-o.value[e])}function V(){B.post("/api/booklet/routine/submit",{style_id:r.value,finish:o.value,message:i.value}).then(e=>{console.log(e.data),c("refresh")}).catch(e=>console.error(e))}const y=D("is_modifying"),h=d([{file:null,title:"",description:""}]),C=d(["/icon/favicon.ico"]);function N(){const e=new FormData;h.value.forEach((s,a)=>{e.append("tasks",s.file),e.append(`taskData${a}`,JSON.stringify({title:s.title,description:s.description}))}),B.post("/api/booklet/routine/style/new",e,{headers:{"Content-Type":"multipart/form-data"},paramsSerializer:s=>qs.stringify(s,{arrayFormat:"repeat"})}).then(s=>console.log(s.data)).catch(s=>{console.error(s)})}function T(e,s){h.value[s].title=e}function L(e,s){h.value[s].description=e}function q(){h.value.push({file:null,title:"",description:""}),C.value.push("/icon/favicon.ico")}function z(e,s){const a=e.target.files[0];if(a){h.value[s].file=a;const _=new FileReader;_.onload=m=>{C.value[s]=m.target.result},_.readAsDataURL(a)}}const E=D("show_imgs");return(e,s)=>(n(),l(b,null,[S(t("ul",P,[(n(!0),l(b,null,w(u.value,(a,_)=>(n(),l("li",{key:_,class:"task"},[t("div",Q,[t("img",{onClick:m=>$(E)(a.image),src:a.image,alt:""},null,8,K)]),t("div",W,[t("div",X,p(a.title),1),t("div",Y,p(a.description),1)]),t("div",{onClick:m=>g(_),class:I([{checked:o.value[_]==1},"task_btn"])},null,10,Z)]))),128))],512),[[R,!$(y)]]),S(t("div",tt,[S(t("textarea",{"onUpdate:modelValue":s[0]||(s[0]=a=>i.value=a),class:"message",placeholder:"给今天的自己留段话吧..."},null,512),[[J,i.value]]),t("input",{onClick:V,type:"button",class:"submit",value:"提交"})],512),[[R,!$(y)]]),$(y)?(n(),l("ul",st,[(n(!0),l(b,null,w(h.value,(a,_)=>(n(),l("li",et,[t("div",ot,[t("input",{onChange:m=>z(m,_),type:"file",class:"file",accept:"image/*"},null,40,it),t("img",{src:C.value[_],alt:""},null,8,at)]),t("div",nt,[t("div",{onBlur:m=>T(m.target.innerText,_),class:"title_box",contenteditable:"true","aria-placeholder":"任务标题."},p(a.title),41,lt),t("div",{onBlur:m=>L(m.target.innerText,_),class:"desc_box",contenteditable:"true","aria-placeholder":"任务描述."},p(a.description),41,ct)])]))),256)),t("div",rt,[t("div",{onClick:q,class:"btn_append"},""),t("div",{onClick:s[1]||(s[1]=a=>y.value=!1),class:"btn_cancel"},""),t("div",{onClick:N,class:"btn_confirm"},"")])])):A("",!0)],64))}},dt=x(_t,[["__scopeId","data-v-6665c37f"]]),ut={class:"battles"},vt={class:"battle_content"},mt={class:"battle_img"},pt=["src"],ft={class:"battle_context"},ht={class:"title_box",contenteditable:"true"},gt={class:"desc_box",contenteditable:"true"},bt={class:"appending"},kt={class:"battle_message"},yt={class:"time_box"},$t={class:"battle_start"},wt={__name:"milestone",emits:["show_info"],setup(k,{emit:f}){const c=d([{_id:{$oid:"684bc6e97a99ce387ac35404"},userId:"",start:"2023-03-18",title:"做个韩漫阅读器",desc:"下拉式,画面大小自适应应该是要很久之后学qt再做,或者时间多用python写",img:"",accomplish:"",message:"2023/3/26,戳啦,感觉完全可以用浏览器实现,变相出口转内销了属于是"},{_id:{$oid:"684d89313fde422362beda76"},userId:"",start:"2023-03-12",title:"浅学JS做个网页.",desc:"how不花钱公开资源",img:"",accomplish:"",message:"2023/6/8借用github域名应该可以,现在的问题就是css和js没入门.继续加油吧!"}]);return f("show_info",[" 共计"," 已完成"]),D("is_modifying"),(o,i)=>(n(),l("ul",ut,[(n(!0),l(b,null,w(c.value,(v,g)=>(n(),l("li",{key:g,class:"battle"},[t("div",vt,[t("div",mt,[t("img",{src:v.img,alt:""},null,8,pt)]),t("div",ft,[t("div",ht,p(v.title),1),t("div",gt,p(v.desc),1)])]),t("div",bt,[t("div",kt,p(v.message),1),t("div",yt,[t("div",$t,p(v.start),1),i[0]||(i[0]=t("div",{class:"battle_done"},"2024-01-02",-1))])])]))),128))]))}},xt=x(wt,[["__scopeId","data-v-8efc9872"]]),Ct={id:"routine"},St={class:"routine_cont"},Bt={class:"inspector"},Dt={class:"punch_info"},Rt={class:"records"},Ft={__name:"bookletFrame",props:{isRoutine:Boolean},setup(k){const f=k,c=d([]);function r(o){c.value=o}const u=d(0);return(o,i)=>(n(),l("div",Ct,[t("div",St,[i[1]||(i[1]=t("div",{class:"upper"},"可尝试将游戏移动到其他位置并更新安装路径。",-1)),(n(),O(G(f.isRoutine?dt:xt),{onRefresh:i[0]||(i[0]=v=>u.value++),key:u.value,onShow_info:r},null,32))]),t("div",Bt,[t("div",Dt,[i[2]||(i[2]=t("div",{class:"avatar_box"},[t("img",{src:U,alt:""})],-1)),t("div",Rt,[(n(!0),l(b,null,w(c.value,(v,g)=>(n(),l("div",{key:g,class:"record"},p(v),1))),128))])]),i[3]||(i[3]=t("div",{class:"anim_box"},[t("img",{src:"",alt:""})],-1))])]))}},It=x(Ft,[["__scopeId","data-v-94da06ce"]]),Vt={id:"shelter"},Nt={class:"side_box iconfont"},Tt={class:"switch_box"},Lt={__name:"bookletView",setup(k){const f=j(),c=d(!0),r=d(!1);return F("is_modifying",r),F("show_imgs",(u,o)=>{f.call_mask_method("show_imgs",u,o)}),(u,o)=>(n(),l("div",Vt,[H(It,{isRoutine:c.value},null,8,["isRoutine"]),t("div",Nt,[o[3]||(o[3]=t("div",{class:"modifying_mask"},null,-1)),t("div",{class:I([{modifying:r.value},"modify_btn"]),onClick:o[0]||(o[0]=i=>r.value=!r.value)},"",2),t("div",Tt,[t("div",{style:M({top:c.value?"0px":"5.1rem"}),class:"highlight_bg"},null,4),t("div",{onClick:o[1]||(o[1]=i=>{c.value=!0,r.value=!1}),class:"routine_btn"},""),t("div",{onClick:o[2]||(o[2]=i=>{c.value=!1,r.value=!1}),class:"milestone_btn"},"")])])]))}},At=x(Lt,[["__scopeId","data-v-bcffc43d"]]);export{At as default};
